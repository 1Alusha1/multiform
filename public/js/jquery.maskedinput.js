!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){var t,n=navigator.userAgent,a=/iphone/i.test(n),i=/chrome/i.test(n),r=/android/i.test(n);e.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},e.fn.extend({caret:function(e,t){var n;return 0===this.length||this.is(":hidden")||this.get(0)!==document.activeElement?void 0:"number"==typeof e?(t="number"==typeof t?t:e,this.each(function(){this.setSelectionRange?this.setSelectionRange(e,t):this.createTextRange&&((n=this.createTextRange()).collapse(!0),n.moveEnd("character",t),n.moveStart("character",e),n.select())})):(this[0].setSelectionRange?(e=this[0].selectionStart,t=this[0].selectionEnd):document.selection&&document.selection.createRange&&(t=(e=0-(n=document.selection.createRange()).duplicate().moveStart("character",-1e5))+n.text.length),{begin:e,end:t})},unmask:function(){return this.trigger("unmask")},mask:function(n,o){var c,l,s,f,u,h,g,m;if(!n&&this.length>0){var d=(c=e(this[0])).data(e.mask.dataName);return d?d():void 0}return o=e.extend({autoclear:e.mask.autoclear,placeholder:e.mask.placeholder,completed:null},o),l=e.mask.definitions,s=[],f=g=n.length,u=null,n=String(n),e.each(n.split(""),function(e,t){"?"==t?(g--,f=e):l[t]?(s.push(RegExp(l[t])),null===u&&(u=s.length-1),e<f&&(h=s.length-1)):s.push(null)}),this.trigger("unmask").each(function(){var c=e(this),d=e.map(n.split(""),function(e,t){if("?"!=e)return l[e]?b(t):e}),p=d.join(""),v=c.val();function $(){if(o.completed){for(var e=u;e<=h;e++)if(s[e]&&d[e]===b(e))return;o.completed.call(c)}}function b(e){return e<o.placeholder.length?o.placeholder.charAt(e):o.placeholder.charAt(0)}function k(e){for(;++e<g&&!s[e];);return e}function y(e,t){var n,a;if(!(e<0)){for(n=e,a=k(t);n<g;n++)if(s[n]){if(a<g&&s[n].test(d[a]))d[n]=d[a],d[a]=b(a);else break;a=k(a)}j(),c.caret(Math.max(u,e))}}function _(e){x(),c.val()!=v&&c.change()}function A(e,t){var n;for(n=e;n<t&&n<g;n++)s[n]&&(d[n]=b(n))}function j(){c.val(d.join(""))}function x(e){var t,n,a,i=c.val(),r=-1;for(t=0,a=0;t<g;t++)if(s[t]){for(d[t]=b(t);a++<i.length;)if(n=i.charAt(a-1),s[t].test(n)){d[t]=n,r=t;break}if(a>i.length){A(t+1,g);break}}else d[t]===i.charAt(a)&&a++,t<f&&(r=t);return e?j():r+1<f?o.autoclear||d.join("")===p?(c.val()&&c.val(""),A(0,g)):j():(j(),c.val(c.val().substring(0,r+1))),f?t:u}c.data(e.mask.dataName,function(){return e.map(d,function(e,t){return s[t]&&e!=b(t)?e:null}).join("")}),c.one("unmask",function(){c.off(".mask").removeData(e.mask.dataName)}).on("focus.mask",function(){var e;!c.prop("readonly")&&(clearTimeout(t),v=c.val(),e=x(),t=setTimeout(function(){c.get(0)===document.activeElement&&(j(),e==n.replace("?","").length?c.caret(0,e):c.caret(e))},10))}).on("blur.mask",_).on("keydown.mask",function e(t){if(!c.prop("readonly")){var n,i,r,o=t.which||t.keyCode;m=c.val(),8===o||46===o||a&&127===o?(i=(n=c.caret()).begin,(r=n.end)-i==0&&(i=46!==o?function e(t){for(;--t>=0&&!s[t];);return t}(i):r=k(i-1),r=46===o?k(r):r),A(i,r),y(i,r-1),t.preventDefault()):13===o?_.call(this,t):27===o&&(c.val(v),c.caret(0,x()),t.preventDefault())}}).on("keypress.mask",function t(n){if(!c.prop("readonly")){var a,i,o,l=n.which||n.keyCode,f=c.caret();!n.ctrlKey&&!n.altKey&&!n.metaKey&&!(l<32)&&l&&13!==l&&(f.end-f.begin!=0&&(A(f.begin,f.end),y(f.begin,f.end-1)),(a=k(f.begin-1))<g&&(i=String.fromCharCode(l),s[a].test(i))&&((function e(t){var n,a,i,r;for(n=t,a=b(t);n<g;n++)if(s[n]){if(i=k(n),r=d[n],d[n]=a,i<g&&s[i].test(r))a=r;else break}}(a),d[a]=i,j(),o=k(a),r)?setTimeout(function(){e.proxy(e.fn.caret,c,o)()},0):c.caret(o),f.begin<=h&&$()),n.preventDefault())}}).on("input.mask paste.mask",function(){!c.prop("readonly")&&setTimeout(function(){var e=x(!0);c.caret(e),$()},0)}),i&&r&&c.off("input.mask").on("input.mask",function e(t){var n=c.val(),a=c.caret();if(m&&m.length&&m.length>n.length){for(x(!0);a.begin>0&&!s[a.begin-1];)a.begin--;if(0===a.begin)for(;a.begin<u&&!s[a.begin];)a.begin++;c.caret(a.begin,a.begin)}else{x(!0);var i=n.charAt(a.begin);a.begin<g&&(s[a.begin]||a.begin++,s[a.begin].test(i)&&a.begin++),c.caret(a.begin,a.begin)}$()}),x()})}})});